####认知觉醒
namespace = azur_R_trait

country_event = {
	id = azur_R_trait.1
	is_triggered_only = yes
	hide_window = yes

	trigger = {
		owner_main_species = {
			has_trait = trait_azur_a1
		}
	}
	
	immediate = {
		set_country_flag = AL_R_ap_AL_R_kansen_species
		every_owned_pop = {
			limit = {
				is_same_species = root
				has_trait = trait_azur_a1
				NOT = { species = { has_trait = trait_azur_feisheng_1 } }
			}
			modify_species = {
				species = this
				add_trait = trait_azur_feisheng_1
			}
		}
		random_owned_pop = {
			limit = { is_same_species = root has_trait = trait_azur_feisheng_1 }
			species = { save_event_target_as = new_main_species }
		}
		change_dominant_species = { species = event_target:new_main_species }
		every_owned_leader = {
			limit = {
				species = { has_trait = trait_azur_a1 }
				NOR = {
					has_trait = leader_trait_tongyong_01
				}
			}
			add_trait_no_notify = leader_trait_tongyong_01
		}
		every_pool_leader = {
			limit = {
				species = { has_trait = trait_azur_a1 }
				NOT = { has_trait = leader_trait_tongyong_01 }
			}
			add_trait_no_notify = leader_trait_tongyong_01
		}
	}
}

#环世界宜居（已失效
country_event = {
	id = azur_R_trait.2
	is_triggered_only = yes
	hide_window = yes

	trigger = {
		owner_main_species = {
			has_trait = trait_azur_a1
		}
	}
	
	immediate = {
		every_owned_pop = {
			limit = {
				is_same_species = root
				has_trait = trait_azur_a1
			}
			modify_species = {
				species = this
				ideal_planet_class = pc_ringworld_habitable
			}
		}
		change_dominant_species = { species = last_created change_all = yes }
	}
}


#开局获得特质修正魔方
country_event = {
	id = azur_R_trait.3
	is_triggered_only = yes
	hide_window = yes

	trigger = {
		owner_main_species = {
			has_trait = trait_azur_a1
		}
	}
	
	immediate = {
		add_relic = relic_azur_R_mofang_02
	}
}

#天运拟合飞升后弹出(待删除
country_event = {
	id = azur_R_trait.4
	title = "azur_e.4.name"
	desc = "azur_e.4.desc"
	picture = GFX_evt_genetic_modification
	show_sound = event_evolution_mastery

	is_triggered_only = yes

	option = {
		name = EXCELLENT
		TRIGGER = {
			OR = {
				NOT = { has_authority = auth_hive_mind }
				has_valid_civic = civic_hive_devouring_swarm
			}
		}
	}

	option = {
		name = EXCELLENT
		custom_tooltip = HIVE_ASSIMILATION_CITIZENSHIP_ENABLED
		trigger = {
			has_authority = auth_hive_mind
			NOT = { has_valid_civic = civic_hive_devouring_swarm }
		}
	}
}

#遗珍测试
country_event = {
	id = azur_R_trait.5
	is_triggered_only = yes
	hide_window = yes

	trigger = {
		has_country_flag = azur_lane_gangqu_country
	}
	
	immediate = {
		add_relic = relic_azur_R_mofang_01
	}
}


#物种整合
country_event = {
	id = azur_R_trait.6
	is_triggered_only = yes
	hide_window = yes

	trigger = {
		has_ascension_perk = ap_AL_R_kansen_species
		has_country_flag = azur_lane_gangqu_country
		has_country_flag = ap_AL_R_kansen_species_traits_success
	}
	
	immediate = {
		set_update_modifiers_batch = begin
		random_owned_species = {
			limit = { 
				is_same_species = root
				has_trait = trait_azur_a1
				has_trait = trait_azur_feisheng_1
			}
			save_event_target_as = azur_R_species_01
		}
		every_owned_pop = {
			limit = {
				has_trait = trait_azur_a1
				NOT = { is_exact_same_species = event_target:azur_R_species_01 }
			}
			change_species = event_target:azur_R_species_01
		}
		change_dominant_species = { species = event_target:azur_R_species_01 }
		set_update_modifiers_batch = end
	}
}

#飞升后通用领袖特质
country_event = {
	id = azur_R_trait.7
	is_triggered_only = yes
	hide_window = yes

	trigger = {
		from = {
			species = {
				has_trait = trait_azur_a1
			}
		}
		has_country_flag = AL_R_ap_AL_R_kansen_species
	}

	immediate = {
		from = {
			add_trait_no_notify = leader_trait_tongyong_01
		}
	}
}

#心智觉醒特殊项目
country_event = {
	id = azur_R_trait.8
	title = "azur_R_trait.8.name"
	desc = "azur_R_trait.8.desc"
	picture = GFX_AL_R_KANSEN_SPECIES_TRAITS
	show_sound = event_evolution_mastery
	location = capital_scope

	is_triggered_only = yes

	option = {
		name = "azur_R_trait.8.option.a"
		custom_tooltip = "azur_R_trait.8.option.a.custom"
		hidden_effect = {
			enable_special_project = {
				name = "AL_R_KANSEN_SPECIES_TRAITS"
				location = capital_scope
				owner = root
			}
		}
	}
}

#特殊项目完成
country_event = {
	id = azur_R_trait.9
	title = "azur_R_trait.9.name"
	desc = "azur_R_trait.9.desc"
	picture = GFX_AL_R_KANSEN_SPECIES_TRAITS
	show_sound = event_evolution_mastery

	is_triggered_only = yes
	
	immediate = {
		set_country_flag = ap_AL_R_kansen_species_traits_success
		
	}

	option = {
		name = "azur_R_trait.9.option.a"
		custom_tooltip = "azur_R_trait.9.option.a.custom"
		add_research_option = tech_azur_R_building_mofang_01
	}
}